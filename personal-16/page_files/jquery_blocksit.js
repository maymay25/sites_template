(function(D){var B={numOfCol:5,offsetX:5,offsetY:5,blockElement:"div"};var C,G;var I=[];if(!Array.prototype.indexOf){Array.prototype.indexOf=function(N){var M=this.length>>>0;var O=Number(arguments[1])||0;O=(O<0)?Math.ceil(O):Math.floor(O);if(O<0){O+=M}for(;O<M;O++){if(O in this&&this[O]===N){return O}}return -1}}var A=function(){I=[];for(var M=0;M<B.numOfCol;M++){E("empty-"+M,M,0,1,-B.offsetY)}};var E=function(S,M,N,O,P){for(var R=0;R<O;R++){var Q=new Object();Q.x=M+R;Q.size=O;Q.endY=N+P+B.offsetY*2;I.push(Q)}};var L=function(M,P){for(var N=0;N<P;N++){var O=J(M+N,"x");I.splice(O,1)}};var J=function(M,N){for(var O=0;O<I.length;O++){var P=I[O];if(N=="x"&&P.x==M){return O}else{if(N=="endY"&&P.endY==M){return O}}}};var H=function(N,M){var O=[];for(var Q=0;Q<M;Q++){O.push(I[J(N+Q,"x")].endY)}var P=Math.min.apply(Math,O);var R=Math.max.apply(Math,O);return[P,R,O.indexOf(P)]};var K=function(P){if(P>1){var N=I.length-P;var T=false;var S,R;for(var Q=0;Q<I.length;Q++){var M=I[Q];var O=M.x;if(O>=0&&O<=N){var U=H(O,P);if(!T){T=true;S=U;R=O}else{if(U[1]<S[1]){S=U;R=O}}}}return[R,S[1]]}else{S=H(0,I.length);return[S[2],S[0]]}};var F=function(Q,P){if(!Q.data("size")||Q.data("size")<0){Q.data("size",1)}else{if(Q.data("size")>B.numOfCol){Q.data("size",B.numOfCol)}}var O=K(Q.data("size"));var M=G*Q.data("size")-(Q.outerWidth()-Q.width());Q.css({"width":M-B.offsetX*2,"left":O[0]*G,"top":O[1],"position":"absolute"});var N=Q.outerHeight();L(O[0],Q.data("size"));E(Q.attr("id"),O[0],O[1],Q.data("size"),N)};D.fn.BlocksIt=function(N){if(N&&typeof N==="object"){D.extend(B,N)}C=D(this);G=C.width()/B.numOfCol;A();C.children(B.blockElement).each(function(O){F(D(this),O)});var M=H(0,I.length);C.height(M[1]+B.offsetY);return this}})(jQuery);